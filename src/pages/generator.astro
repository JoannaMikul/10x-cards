---
import Layout from "../layouts/Layout.astro";
import { GeneratorPage } from "../components/generator/GeneratorPage";

const BASE_MODELS = [
  { label: "Xiaomi Mimo V2 Flash", value: "xiaomi/mimo-v2-flash:free" },
  { label: "Kwai Pilot Kat Coder Pro", value: "kwaipilot/kat-coder-pro:free" },
  { label: "Google Gemma 3 27B IT", value: "google/gemma-3-27b-it:free" },
  { label: "Claude 3.5 Sonnet", value: "anthropic/claude-3.5-sonnet" },
  { label: "Grok Code Fast 1", value: "x-ai/grok-code-fast-1" },
];

const AVAILABLE_MODELS = (() => {
  const defaultModel = process.env.OPENROUTER_DEFAULT_MODEL || import.meta.env.OPENROUTER_DEFAULT_MODEL;
  if (!defaultModel) return BASE_MODELS;

  const existingModel = BASE_MODELS.find((model) => model.value === defaultModel);
  if (existingModel) return BASE_MODELS;

  return [{ label: `${defaultModel} (Default)`, value: defaultModel }, ...BASE_MODELS];
})();

const defaultModel =
  process.env.OPENROUTER_DEFAULT_MODEL || import.meta.env.OPENROUTER_DEFAULT_MODEL || AVAILABLE_MODELS[0].value;
---

<Layout title="Generator AI - 10x-cards">
  <main class="min-h-[calc(100vh-3rem)] bg-background pr-6 pl-6">
    <div class="max-w-4xl mx-auto">
      <GeneratorPage client:load availableModels={AVAILABLE_MODELS} {defaultModel} />
    </div>
  </main>
</Layout>
